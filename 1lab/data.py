import numpy as np
from scipy import stats

# Основные факторы: х0, х1, х2, х3
X = np.array([
    [1, -1, -1, -1],  # Строка 1
    [1, 1, -1, -1],   # Строка 2
    [1, -1, 1, -1],   # Строка 3
    [1, 1, 1, -1],    # Строка 4
    [1, -1, -1, 1],   # Строка 5
    [1, 1, -1, 1],    # Строка 6
    [1, -1, 1, 1],    # Строка 7
    [1, 1, 1, 1]      # Строка 8
])

# Взаимодействия (x1*x2, x1*x3, x2*x3, x1*x2*x3)
X_interactions = np.array([
    [1, 1,  1, -1],  # Строка 1
    [-1, -1, 1, 1],   # Строка 2
    [-1, 1, -1, 1],   # Строка 3
    [1, -1, -1, -1],  # Строка 4
    [1, -1, -1, 1],    # Строка 5
    [-1, 1, -1, -1],  # Строка 6
    [-1, -1, 1, -1],    # Строка 7
    [1, 1, 1, 1]   # Строка 8
])

# Соединяем основные факторы и все взаимодействия в общую матрицу
X_full = np.hstack([X, X_interactions])

# Y-данные
Y_mean = np.array([2.1, 5.9, 4.1, 7.9, 10.1, 17.9, 8.1, 12.0])

# Матрица откликов
Y = np.array([
    [2.0, 2.1],   # Опыт 1
    [5.9, 6.1],   # Опыт 2
    [4.1, 3.9],   # Опыт 3
    [7.9, 8.1],   # Опыт 4
    [10.1, 9.9],  # Опыт 5
    [17.9, 18.1], # Опыт 6
    [8.1, 7.9],   # Опыт 7
    [12.0, 11.0]  # Опыт 8
])

# Рассчитаем среднее значение Y для каждого опыта
Y_mean = Y.mean(axis=1)

# Добавляем константный столбец для x0
X0 = np.ones((8, 1))
X_full = np.hstack([X0, X_full])  # Добавляем столбец для x0

# Находим коэффициенты регрессии методом наименьших квадратов
coefficients = np.linalg.lstsq(X_full, Y_mean, rcond=None)[0]

